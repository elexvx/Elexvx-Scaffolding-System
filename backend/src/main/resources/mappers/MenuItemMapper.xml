<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tencent.tdesign.mapper.MenuItemMapper">
  <sql id="BaseSelect">
    SELECT id,
      parent_id,
      node_type,
      path,
      route_name,
      component,
      redirect,
      title_zh_cn,
      title_en_us,
      icon,
      hidden,
      frame_src,
      frame_blank,
      enabled,
      required_modules,
      order_no,
      actions,
      version,
      created_at,
      updated_at
    FROM sys_menu_items
  </sql>

  <select id="count" resultType="long">
    SELECT COUNT(1) FROM sys_menu_items
  </select>

  <select id="selectAll" resultType="com.tencent.tdesign.entity.MenuItemEntity">
    <include refid="BaseSelect" />
  </select>

  <select id="selectAllEnabled" resultType="com.tencent.tdesign.entity.MenuItemEntity">
    <include refid="BaseSelect" />
    WHERE enabled = 1
  </select>

  <select id="selectById" resultType="com.tencent.tdesign.entity.MenuItemEntity">
    <include refid="BaseSelect" />
    WHERE id = #{id}
  </select>

  <select id="selectByRouteName" resultType="com.tencent.tdesign.entity.MenuItemEntity">
    <include refid="BaseSelect" />
    WHERE route_name = #{routeName}
  </select>

  <insert id="insert" parameterType="com.tencent.tdesign.entity.MenuItemEntity" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO sys_menu_items (
      parent_id,
      node_type,
      path,
      route_name,
      component,
      redirect,
      title_zh_cn,
      title_en_us,
      icon,
      hidden,
      frame_src,
      frame_blank,
      enabled,
      required_modules,
      order_no,
      actions,
      version
    )
    VALUES (
      #{parentId},
      #{nodeType},
      #{path},
      #{routeName},
      #{component},
      #{redirect},
      #{titleZhCn},
      #{titleEnUs},
      #{icon},
      #{hidden},
      #{frameSrc},
      #{frameBlank},
      #{enabled},
      #{requiredModules},
      #{orderNo},
      #{actions},
      #{version}
    )
  </insert>

  <update id="update" parameterType="com.tencent.tdesign.entity.MenuItemEntity">
    UPDATE sys_menu_items
    SET
      parent_id = #{parentId},
      node_type = #{nodeType},
      path = #{path},
      route_name = #{routeName},
      component = #{component},
      redirect = #{redirect},
      title_zh_cn = #{titleZhCn},
      title_en_us = #{titleEnUs},
      icon = #{icon},
      hidden = #{hidden},
      frame_src = #{frameSrc},
      frame_blank = #{frameBlank},
      enabled = #{enabled},
      required_modules = #{requiredModules},
      order_no = #{orderNo},
      actions = #{actions},
      version = version + 1
    WHERE id = #{id}
      AND version = #{version}
  </update>

  <delete id="deleteById">
    DELETE FROM sys_menu_items WHERE id = #{id}
  </delete>

  <delete id="deleteByIds">
    DELETE FROM sys_menu_items
    WHERE id IN
    <foreach collection="ids" item="id" open="(" close=")" separator=",">
      #{id}
    </foreach>
  </delete>
</mapper>
